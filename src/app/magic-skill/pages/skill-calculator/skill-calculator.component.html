<div class="skill-calculator-container">
  <div
    class="points-display"
    [class.warning]="isLimitReached()"
    [class.error]="isLimitExceeded()"
  >
    <div class="points-info">
      <span class="points-label">Points Spent:</span>
      <span class="points-value">{{ currentCost() }}</span>
      <span class="points-separator">/</span>
      <span class="points-max">{{
        skillCalculatorService.MAXIMUM_POINTS
      }}</span>
    </div>
    <div class="points-remaining">
      <span class="remaining-label">Remaining:</span>
      <span class="remaining-value">{{ remainingPoints() }}</span>
    </div>
    @if (isLimitExceeded()) {
      <div class="warning-message error-message">
        ⚠️ You have exceeded the maximum points limit!
      </div>
    } @else if (isLimitReached()) {
      <div class="warning-message">
        ⚠️ You have reached the maximum points limit!
      </div>
    }
    @if (warningMessage()) {
      <div class="warning-message blocked-selection-message">
        {{ warningMessage() }}
      </div>
    }
  </div>
  <table class="skills-table">
    <thead>
      <tr>
        <th ass="fami  -header">Family</th>
        @for (tier of tiers; track tier) {
          <th [class]="getTierClass(tier)">
            {{ getTierLabel(tier) }}
          </th>
        }
      </tr>
    </thead>
    <tbody>
      @for (familyRow of familyRows; track familyRow.family.id) {
        <tr>
          <td class="family-name">{{ familyRow.family.name }}</td>
          @for (tier of tiers; track tier) {
            <td [class]="getTierClass(tier)">
              <div class="skill-list">
                @for (
                  skill of getSkillsForFamilyAndTier(familyRow, tier);
                  track skill.id
                ) {
                  <app-checkbox
                    class="skill-box"
                    [label]="skill.name"
                    [checked]="isSkillSelected(skill.id)"
                    [triggerBlink]="getBlinkCounter(skill.id)"
                    (checkedChange)="onSkillToggle(skill.id, $event)"
                  />
                }
              </div>
            </td>
          }
        </tr>
      }
    </tbody>
  </table>
</div>
